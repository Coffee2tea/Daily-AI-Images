<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scraped Results - T-Shirt Design App</title>
    <meta name="description" content="Trending T-Shirt designs scraped from the web">
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="/nav-component.js"></script>
</head>

<body>
    <!-- Navigation -->
    <nav-menu></nav-menu>

    <!-- Animated Background -->
    <div class="bg-animation"></div>

    <!-- Main Content -->
    <div class="container" style="padding-top: 80px;">
        <header class="gallery-header">
            <h1 class="gallery-title"><span class="material-symbols-outlined icon-gradient"
                    style="font-size: 1.2em;">image_search</span> Scraped Designs</h1>
            <p class="gallery-subtitle">Trending T-Shirt designs scraped from Google to inspire AI creation</p>
        </header>

        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Loading scraped images...</p>
        </div>

        <!-- Empty State -->
        <div id="empty-state" class="confirm-card"
            style="display: none; max-width: 500px; margin: 2rem auto; text-align: center;">
            <div style="font-size: 4rem; margin-bottom: 1rem;" class="material-symbols-outlined">image_not_supported
            </div>
            <h2 style="color: rgba(255,255,255,0.9); margin-bottom: 1rem;">No images found</h2>
            <p style="color: rgba(255,255,255,0.6); margin-bottom: 2rem;">Please run the workflow from the dashboard
                first</p>
            <a href="/dashboard" class="btn btn-primary">Go to Dashboard</a>
        </div>

        <!-- Gallery Grid -->
        <div id="gallery" class="gallery-grid grid-4" style="display: none;"></div>

        <!-- Info -->
        <div id="info"
            style="display: none; text-align: center; margin-top: 2rem; color: rgba(255,255,255,0.5); font-size: 0.9rem;">
            <p><span class="material-symbols-outlined"
                    style="vertical-align: middle; font-size: 1.2em;">lightbulb</span> Click on an image to open the
                original link</p>
        </div>
    </div>

    <style>
        .scraped-item {
            position: relative;
            overflow: hidden;
            border-radius: var(--radius-lg);
            background: var(--surface-container);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            box-shadow: var(--shadow-1);
        }

        .scraped-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-3);
        }

        .scraped-image {
            width: 100%;
            aspect-ratio: 1;
            object-fit: cover;
        }

        .scraped-info {
            padding: 1rem;
        }

        .scraped-title {
            color: var(--text-primary);
            font-size: 0.95rem;
            margin: 0 0 0.5rem 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .scraped-meta {
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .scraped-price {
            color: #10b981;
            font-weight: 600;
        }

        .scraped-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.8), rgba(118, 75, 162, 0.8));
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .scraped-item:hover .scraped-overlay {
            opacity: 1;
        }

        .scraped-overlay span {
            color: white;
            font-size: 1rem;
            font-weight: 500;
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', loadScrapedImages);

        async function loadScrapedImages() {
            const loading = document.getElementById('loading');
            const gallery = document.getElementById('gallery');
            const emptyState = document.getElementById('empty-state');
            const info = document.getElementById('info');

            try {
                const response = await fetch('/api/scraped');
                const data = await response.json();

                loading.style.display = 'none';

                if (data.success && data.images && data.images.length > 0) {
                    renderGallery(data.images);
                    gallery.style.display = 'grid';
                    info.style.display = 'block';
                } else {
                    emptyState.style.display = 'block';
                }
            } catch (error) {
                console.error('Error loading scraped images:', error);
                loading.style.display = 'none';
                emptyState.style.display = 'block';
            }
        }

        function renderGallery(images) {
            const gallery = document.getElementById('gallery');

            gallery.innerHTML = images.map((img, index) => `
        <div class="scraped-item" onclick="openEtsy('${img.url || '#'}')">
          <img 
            class="scraped-image" 
            src="${img.localPath || img.imageUrl}" 
            alt="${img.title || 'Etsy Design'}"
            onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22400%22 viewBox=%220 0 400 400%22><rect fill=%22%231a1a2e%22 width=%22400%22 height=%22400%22/><text x=%2250%%22 y=%2250%%22 fill=%22%23667eea%22 font-size=%2248%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22>ðŸ“·</text></svg>'"
          >
          <div class="scraped-overlay">
            <span class="material-symbols-outlined">link</span>
            <span>View Original</span>
          </div>
          <div class="scraped-info">
            <h3 class="scraped-title">${img.title || `Design ${index + 1}`}</h3>
            <div class="scraped-meta">
              <span class="scraped-price">${img.price || ''}</span>
              <span>${img.shop || 'Etsy Shop'}</span>
            </div>
          </div>
        </div>
      `).join('');
        }

        function openEtsy(url) {
            if (url && url !== '#') {
                window.open(url, '_blank');
            }
        }
    </script>
</body>

</html>